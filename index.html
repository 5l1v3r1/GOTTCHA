<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="GOTTCHA : Accurate read-based metagenome characterization using a hierarchical suite of unique signatures">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>GOTTCHA</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/LANL-Bioinformatics/GOTTCHA">View on GitHub</a>

          <h1 id="project_title">GOTTCHA</h1>
          <h2 id="project_tagline">Accurate read-based metagenome characterization using a hierarchical suite of unique signatures</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/LANL-Bioinformatics/GOTTCHA/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/LANL-Bioinformatics/GOTTCHA/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="genomic-origin-through-taxonomic-challenge-gottcha" class="anchor" href="#genomic-origin-through-taxonomic-challenge-gottcha" aria-hidden="true"><span class="octicon octicon-link"></span></a>Genomic Origin Through Taxonomic CHAllenge (GOTTCHA)</h1>

<p>GOTTCHA is an application of a novel, gene-independent and signature-based metagenomic
taxonomic profiling method with significantly smaller false discovery rates (FDR) that is 
laptop deployable. Our algorithm was tested and validated on twenty synthetic and mock 
datasets ranging in community composition and complexity, was applied successfully to data
generated from spiked environmental and clinical samples, and robustly demonstrates 
superior performance compared with other available tools.</p>

<hr>

<h2>
<a id="system-requirement" class="anchor" href="#system-requirement" aria-hidden="true"><span class="octicon octicon-link"></span></a>SYSTEM REQUIREMENT</h2>

<p>Linux (2.6 kernel or later) or Mac (OSX 10.6 Snow Leopard or later) operating system
with minimal 8 GB of RAM is recommended. Perl v5.8 or above is required. The C/C++
compiling enviroment might be required for installing dependencies. Systems may vary.
Please assure that your system has the essential software building packages (e.g. build-essential
for Ubuntu, XCODE for Mac...etc) installed properly before running the installing 
script.</p>

<p>GOTTCHA was tested successfully on our Linux servers (Ubuntu 12.10 w/ Perl v5.14.2; 
Ubuntu 10.04 w/ Perl v5.10.1) and Macbook Pro laptops (MAC OSX 10.8 w/ XCODE v5.1).</p>

<hr>

<h2>
<a id="quick-start" class="anchor" href="#quick-start" aria-hidden="true"><span class="octicon octicon-link"></span></a>QUICK START</h2>

<p>This is an example of profiling a "test.fastq" file using GOTTCHA with a species-level
pre-computed bacterial database. The testing FASTQ file comes along with the GOTTCHA package
in the "test" directory. More details are stated in the INSTRUCTION section.</p>

<ol>
<li>
<p>Obtaining GOTTCHA package:</p>

<pre><code>$ git clone https://github.com/LANL-Bioinformatics/GOTTCHA.git gottcha
</code></pre>
</li>
<li>
<p>Installing GOTTCHA:</p>

<pre><code>$ cd gottcha
$ ./INSTALL.sh
</code></pre>
</li>
<li>
<p>Downloading lookup table and species-level database from our SFTP server.
Use '9001gottcha' as the password when the request prompts:</p>

<pre><code>$ sftp -o "Port 33001" gottcha@img-gp.lanl.gov:gottcha/GOTTCHA_lookup.tar.gz ./
$ sftp -o "Port 33001" gottcha@img-gp.lanl.gov:gottcha/GOTTCHA_BACTERIA_c3514_k24_u24.species.tar.gz ./
</code></pre>

<p>If you have any difficulty obtaining the databases, please contact Po-E Li <a href="mailto:po-e@lanl.gov">po-e@lanl.gov</a>.</p>
</li>
<li>
<p>Unpacking and decompressing archives:</p>

<pre><code>$ tar -zxvf GOTTCHA_lookup.tar.gz
$ tar -zxvf GOTTCHA_BACTERIA_c3514_k24_u24.species.tar.gz
</code></pre>
</li>
<li>
<p>Running gottcha.pl: </p>

<pre><code>$ bin/gottcha.pl             \
     --threads 8             \
     --outdir ./             \
     --input test/test.fastq \
     --database database/GOTTCHA_BACTERIA_c3514_k24_u24.species
</code></pre>
</li>
<li><p>Enjoying the result at './test.gottcha.tsv'.</p></li>
</ol>

<hr>

<h2>
<a id="detail-instructions" class="anchor" href="#detail-instructions" aria-hidden="true"><span class="octicon octicon-link"></span></a>DETAIL INSTRUCTIONS</h2>

<p>The detail of steps in the above section will be descrbed in this section. Note that all 
instructions in this document use pre-computed databases downloaded from our SFTP site.</p>

<p>If you are looking for instructions to build a CUSTOM database and/or running GOTTCHA
step-by-step, please read README_FULL.md.</p>

<hr>

<h3>
<a id="obtaining-gottcha" class="anchor" href="#obtaining-gottcha" aria-hidden="true"><span class="octicon octicon-link"></span></a>Obtaining GOTTCHA</h3>

<p>The source codes can be downloading from <a href="https://bitbucket.org/poeli/gottcha">here</a>.
The pre-computed databases need to be downloaded separately from our SFTP server.
Please see below in the [Obtaining Pre-computed Databases] section.</p>

<p>You can use "git" to obtain the package:</p>

<pre><code>    $ git clone https://bitbucket.org/poeli/gottcha
</code></pre>

<p>or download the compressed archive in
 <a href="https://bitbucket.org/poeli/gottcha/get/master.zip">zip</a>,
 <a href="https://bitbucket.org/poeli/gottcha/get/master.tar.gz">gz</a> or 
 <a href="https://bitbucket.org/poeli/gottcha/get/master.tar.bz2">bz2</a>.</p>

<hr>

<h3>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h3>

<p>The GOTTCHA profiling and database-generating scripts are primarily Perl-based, and require at
least Perl v5.8 with dependencies installed properly (listed in README_FULL.md).
The splitrim tool is written in <a href="http://www.dlang.org">D</a> that requires an appropriate D 
compiler to complie it. GOTTCHA utilizes <a href="https://github.com/lh3/bwa">BWA</a> with the BWA-MEM algorithm
for read mapping. You can either keep "dmd" and "bwa" in your system path or simply 
run the installation script - INSTALL.sh. This script will check and try to install missing 
tools and dependencies:</p>

<pre><code>    $ ./INSTALL.sh
</code></pre>

<p>After running INSTALL.sh successfully, the binaries and related scripts will be stored
in the ./bin directory.</p>

<hr>

<h3>
<a id="obtaining-pre-computed-databases" class="anchor" href="#obtaining-pre-computed-databases" aria-hidden="true"><span class="octicon octicon-link"></span></a>Obtaining Pre-computed Databases</h3>

<p>Databases of unique genome segments at multiple taxonomic levels (e.g. family, species, 
genus, strain-level, etc.) are used for taxonomic classification of reads. Variants of 
these databases, in which all human 24-mers were removed were also generated and used in 
this study. These 24-mers were derived from the GRCh37.p10 (Genome Reference Consortium),
HuRef (J. Craig Venter Institute), and CHM1_1.0 (Washington U. School of Medicine) 
assemblies and include unplaced scaffolds. For example, 
GOTTCHA_BACTERIA_c3514_k24_u24_xHUMAN3x.species.tar.gz is a GOTTCHA bacterial 
species-level signature database that was produced by eliminating shared 24-mer (k24) sequences from
3514 bacterial replicons (c3514; includes both chromosomes and plasmids) and 3 human genomes (xHuman3X), 
while retaining a minimum of 24bp of unique fragments (u24).</p>

<p>The compressed database archives are available for users to download from our SFTP 
server with the credential below:</p>

<blockquote>
<p>SFTP server: img-gp.lanl.gov<br>
Port: 33001<br>
username: gottcha<br>
password: 9001gottcha   </p>
</blockquote>

<p>GOTTCHA requires a taxanomic lookup table (GOTTCHA_lookup.tar.gz) and a pre-computed
database (e.g: GOTTCHA_BACTERIA_c3514_k24_u24_xHUMAN3x.species.tar.gz) to classify reads.
These signature databases could be huge. We highly recommend that users also download the
corresponding *.md5 file for verification.</p>

<p>You can use the 'sftp' command to download both archives, one at a time:</p>

<pre><code>    $ sftp -o "Port 33001" gottcha@img-gp.lanl.gov:gottcha/GOTTCHA_lookup.tar.gz ./
    $ sftp -o "Port 33001" gottcha@img-gp.lanl.gov:gottcha/GOTTCHA_BACTERIA_c3514_k24_u24_xHUMAN3x.species.tar.gz ./
</code></pre>

<p>Then use 'tar' to unpack and decompress both archives:</p>

<pre><code>    $ tar -zxvf GOTTCHA_lookup.tar.gz
    $ tar -zxvf GOTTCHA_BACTERIA_c3514_k24_u24_xHUMAN3x.species.tar.gz
</code></pre>

<p>Files will be expanded to ./database directory by default.</p>

<p>Here is a list of the available pre-computed databases. Note that these databases are
also available in FASTA format at gottcha/FASTA/:</p>

<ul>
<li>GOTTCHA_BACTERIA_c3514_k24_u24.class.tar.gz (4.6GB)</li>
<li>GOTTCHA_BACTERIA_c3514_k24_u24.family.tar.gz (4.6GB)</li>
<li>GOTTCHA_BACTERIA_c3514_k24_u24.genus.tar.gz (4.5GB)</li>
<li>GOTTCHA_BACTERIA_c3514_k24_u24.order.tar.gz (4.6GB)</li>
<li>GOTTCHA_BACTERIA_c3514_k24_u24.phylum.tar.gz (4.6GB)</li>
<li>GOTTCHA_BACTERIA_c3514_k24_u24.species.tar.gz (4.3GB)</li>
<li>GOTTCHA_BACTERIA_c3514_k24_u24.strain.tar.gz (3.9GB)</li>
<li>GOTTCHA_BACTERIA_c3514_k24_u24_xHUMAN3x.genus.tar.gz (4.5GB)</li>
<li>GOTTCHA_BACTERIA_c3514_k24_u24_xHUMAN3x.species.tar.gz (4.3GB)</li>
<li>GOTTCHA_BACTERIA_c3514_k24_u24_xHUMAN3x.strain.tar.gz (3.8GB)</li>
<li>GOTTCHA_VIRUSES_c3498_k85_u24.genus.tar.gz (71MB)</li>
<li>GOTTCHA_VIRUSES_c3498_k85_u24.species.tar.gz (68MB)</li>
<li>GOTTCHA_VIRUSES_c3498_k85_u24.strain.tar.gz (68MB)</li>
<li>GOTTCHA_VIRUSES_c3498_k85_u24_xHUMAN3x.genus.tar.gz (71MB)</li>
<li>GOTTCHA_VIRUSES_c3498_k85_u24_xHUMAN3x.species.tar.gz (68MB)</li>
<li>GOTTCHA_VIRUSES_c3498_k85_u24_xHUMAN3x.strain.tar.gz (68MB)</li>
</ul>

<p>Note: We have noticed that our SFTP server doesn't work for some IPs.
If you have any difficulty obtaining the databases, please contact Po-E Li <a href="mailto:po-e@lanl.gov">po-e@lanl.gov</a>.</p>

<hr>

<h3>
<a id="running-gottcha" class="anchor" href="#running-gottcha" aria-hidden="true"><span class="octicon octicon-link"></span></a>Running GOTTCHA</h3>

<p>The procedure includes 3 major steps: (1) split-trimming the input data, (2) mapping reads 
to a GOTTCHA database using BWA, and (3) profiling/filtering the results. These steps have
been wrapped into a sigle script called 'gottcha.pl'. User will need to provide a FASTQ file
as input and specify the location and name of the database.</p>

<p>Here is the general usage to run GOTTCHA:</p>

<blockquote>
<p>$ bin/gottcha.pl -i &lt;FASTQ&gt; -d &lt;PATH/DATABASE_PREFIX&gt;</p>
</blockquote>

<p>We provided a testing FASTQ file and example output in ./test. The following command
is an example that runs "test.fastq" through GOTTCHA using a species-level database with
8 threads:</p>

<pre><code>    $ bin/gottcha.pl             \
         --threads 8             \
         --mode all              \
         --input test/test.fastq \
         --database database/GOTTCHA_BACTERIA_c3514_k24_u24_xHUMAN3x.species
</code></pre>

<p>In this case, we specify the output mode to "all" using "--mode all" option that
gives us two output files and all intermediate ouptuts stored in "test_temp"
directory. Both outputs are plain text files in tab-separated values format:
a summary table "test.gottcha.tsv" and a full information table 
"test.gottcha_full.tsv".</p>

<hr>

<h3>
<a id="interpreting-results" class="anchor" href="#interpreting-results" aria-hidden="true"><span class="octicon octicon-link"></span></a>Interpreting Results</h3>

<p>GOTTCHA reports profiling results in a neat summary table (*.gottcha.tsv) by default.
The tsv file will list the organism(s) at all taxonomic levels from STRAIN to PHYLUM,
their linear length, total bases mapped, linear depth of coverage, and the normalized 
linear depth of coverage. The linear depth of coverage (LINEAR_DOC) is used to calculate 
relative abundance of each organism or taxonomic name in the sample.</p>

<p>Summary table:</p>

<table>
<thead>
<tr>
<th>Column</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>LEVEL</td>
<td>taxonomic rank</td>
</tr>
<tr>
<td>NAME</td>
<td>taxonomic name</td>
</tr>
<tr>
<td>REL_ABUNDANCE</td>
<td>relative abundance (equivalent to NORM_COV by default)</td>
</tr>
<tr>
<td>LINEAR_LENGTH</td>
<td>number of non-overlapping bases covering the signatures</td>
</tr>
<tr>
<td>TOTAL_BP_MAPPED</td>
<td>sum total of all hit lengths recruited to signatures</td>
</tr>
<tr>
<td>HIT_COUNT</td>
<td>number of hits recruited to signatures</td>
</tr>
<tr>
<td>HIT_COUNT_PLASMID</td>
<td>number of hits recruited to signatures</td>
</tr>
<tr>
<td>READ_COUNT</td>
<td>number of reads recruited to signatures</td>
</tr>
<tr>
<td>LINEAR_DOC</td>
<td>linear depth-of-coverage (TOTAL_BP_MAPPED / LINEAR_LENGTH)</td>
</tr>
<tr>
<td>NORM_COV</td>
<td>normalized linear depth-of-coverage (LINEAR_DOC / SUM(LINEAR_DOC in certain level))</td>
</tr>
</tbody>
</table>

<p>There are two report modes available. Other than a summary table, "full" report 
mode will report a table with more detail information from unfiltered results. 
The explanation of each column in the full report can be found in README_REPORT.md
The "all" report mode will keep all output files that were generated by each 
profiling step.</p>

<hr>

<h3>
<a id="visulizing-results-using-krona" class="anchor" href="#visulizing-results-using-krona" aria-hidden="true"><span class="octicon octicon-link"></span></a>Visulizing Results using Krona</h3>

<p><a href="http://sourceforge.net/p/krona/home/krona/">Krona</a> is an interactive browser that allows 
the exploration of hierarchical data with pie charts. Assuming you have Krona installed properly,
we are going to create a Krona chart from a text file listing abundance and lineages. 
You will find .lineage.tsv file when you run gottcha.pl in "all" output mode.</p>

<p>Use 'ktImportText' and save the chart to "test.krona.html":</p>

<pre><code>    $ ktImportText test_temp/test.lineage.tsv -o test.krona.html
</code></pre>

<hr>

<h2>
<a id="citation" class="anchor" href="#citation" aria-hidden="true"><span class="octicon octicon-link"></span></a>CITATION</h2>

<p>Tracey Allen K. Freitas, Po-E Li, Matthew B. Scholz and Patrick S. G. Chain (2015) <strong>Accurate read-based metagenome characterization using a hierarchical suite of unique signatures,</strong> Nucleic Acids Research (DOI: 10.1093/nar/gkv180)</p>

<hr>

<h2>
<a id="authors" class="anchor" href="#authors" aria-hidden="true"><span class="octicon octicon-link"></span></a>AUTHORS</h2>

<p>Tracey Allen K. Freitas, Po-E Li, Matthew B. Scholz, Patrick S. G. Chain
Bioscience Division, Los Alamos National Laboratory, Los Alamos, NM 87545</p>

<hr>

<h2>
<a id="acknowledgements" class="anchor" href="#acknowledgements" aria-hidden="true"><span class="octicon octicon-link"></span></a>ACKNOWLEDGEMENTS</h2>

<p>We would like to thank Jason Gans for critical discussions on classification and machine 
learning techniques, and Shihai Feng for the generation of synthetic datasets.</p>

<p>This project is funded by U.S. Defense Threat Reduction Agency [R-00059-12-0 and R-00332-13-0 to P.S.G.C.].</p>

<hr>

<h2>
<a id="change-log" class="anchor" href="#change-log" aria-hidden="true"><span class="octicon octicon-link"></span></a>CHANGE LOG</h2>

<p>Version 1.0:</p>

<blockquote>
<ol>
<li>Report the number of reads that hit to plasmids and provide an option to ignore them.</li>
<li>Report the number of READ_COUNT.</li>
</ol>
</blockquote>

<p>Version 0.9e:</p>

<blockquote>
<ol>
<li>Fix minor bugs</li>
<li>Amend the display of runtime information</li>
</ol>
</blockquote>

<p>Version 0.9d:</p>

<blockquote>
<ol>
<li>Splitrim allows lower-case bases in fastq file</li>
<li>Fix bugs that fail to specify output directory</li>
<li>Minor bug fix</li>
</ol>
</blockquote>

<p>Version 0.9c:</p>

<blockquote>
<ol>
<li>Fix FASTQ header compatibility</li>
<li>Provide more information while running GOTTCHA</li>
</ol>
</blockquote>

<p>Version 0.9b (05/12/2014):</p>

<blockquote>
<ol>
<li>Add '--stDir' option for pre-splitrimmed input file</li>
<li>Performance improvement</li>
</ol>
</blockquote>

<p>Version 0.9a (04/30/2014):</p>

<blockquote>
<ol>
<li>Provide bwaOpt option for user to use their own parameters to run BWA-MEM.</li>
<li>Use absolute path to run system calls</li>
<li>Provide 'relAbui' option to choose column to calculate relative abundance.</li>
</ol>
</blockquote>

<p>Version 0.9:</p>

<blockquote>
<ol>
<li>Initial release</li>
</ol>
</blockquote>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">GOTTCHA maintained by <a href="https://github.com/LANL-Bioinformatics">LANL-Bioinformatics</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
